<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Extracting Data from Rasters" />
<meta property="og:description" content="This document shows you how to extract data from rasters.
Getting The Libraries First, I&rsquo;ll load in some packages to get the ability to work with raster data and to load in the Arapatus attenuatus data set (it is part of the default gstudio package).
require(raster) require(gstudio)
## ##Loading and Cropping Rasters We can load in the raster, and then crop it to just the are we need. These rasters were downloaded from [ http://www." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://dyerlab/2015/01/extracting-data-from-rasters/" />


<meta property="og:updated_time" content="2015-01-10T00:00:00&#43;00:00"/>











<meta itemprop="name" content="Extracting Data from Rasters">
<meta itemprop="description" content="This document shows you how to extract data from rasters.
Getting The Libraries First, I&rsquo;ll load in some packages to get the ability to work with raster data and to load in the Arapatus attenuatus data set (it is part of the default gstudio package).
require(raster) require(gstudio)
## ##Loading and Cropping Rasters We can load in the raster, and then crop it to just the are we need. These rasters were downloaded from [ http://www.">


<meta itemprop="dateModified" content="2015-01-10T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="816">



<meta itemprop="keywords" content="2gener,aflp,applied-population-genetics,araptus-attenuata,baja-california,blog,ces,cgd,code,default-calendar,documents,dogwood,dyerlab,edna,fitness,gdistance,gene-flow,genetic-structure,genomics,ggplot2,google,google-docs,graduate,gsl,gstudio,laboratory,landscape-genetics,lophocereus-schottii,main-menu,manuscripts,maps,markers,null-alleles,ole2015,online,online-publishing,paternity,people,phylogeography,polygon,popgraph,population-genetics,population-graphs,presentations,projects,protocols,publications,r,raster,reproducible-research,research,rstudio,servers,slack,software,spatial,stamova,sturgeon,sustainability,teaching,theory,tutorial,tutorials,uncategorized,unix,urbanization,vcu,vcugenetics2015,xcode," />



  <meta name="twitter:card" content="summary"/>



<meta name="twitter:title" content="Extracting Data from Rasters"/>
<meta name="twitter:description" content="This document shows you how to extract data from rasters.
Getting The Libraries First, I&rsquo;ll load in some packages to get the ability to work with raster data and to load in the Arapatus attenuatus data set (it is part of the default gstudio package).
require(raster) require(gstudio)
## ##Loading and Cropping Rasters We can load in the raster, and then crop it to just the are we need. These rasters were downloaded from [ http://www."/>
<meta name="twitter:site" content="@dyerlab"/>









<meta name="generator" content="Hugo 0.18.1" />


    <link rel="canonical" href="http://dyerlab/2015/01/extracting-data-from-rasters/">

    <title>Extracting Data from Rasters | The Dyer Laboratory</title>

    <!-- combined, minified CSS -->
    <link href="http://dyerlab/css/style.css" rel="stylesheet" integrity="sha384-qRVpIj9hSzsBhmO8Y7YEKF2UFra2sJQtl9V/uFKKDvy&#43;Wjh9zgTku6VRgT8YdPoD" crossorigin="anonymous">

    

    

    

    
<link rel="stylesheet" href="/css/dyerlab.css">
<script>
  (function() {
    var cx = '005624429758912894427:ewy8fmekoli';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
  </head>

  <body>

    <div class="blog-masthead">
      <div class="container">
        <nav class="nav blog-nav">
          <a class="nav-link " href="http://dyerlab/">Home</a>
          
          
          <a class="nav-link" href="http://dyerlab/people/">People</a>
          
          <a class="nav-link" href="http://dyerlab/publications/">Publications</a>
          
          <a class="nav-link" href="http://dyerlab/texts/">Texts</a>
          
          
        </nav>
      </div>
    </div>

    <header class="blog-header">
      <div class="container">
        <h1 class="blog-title"><a href="http://dyerlab/" rel="home">The Dyer Laboratory</a></h1>
        <p class="lead blog-description">Illuminating the mechanics of genetic connectivity.</p>
      </div>
    </header>

    <div class="container">
      <div class="row">
        <div class="col-sm-8 blog-main">

          


<article class="blog-post">
  <header>
    <h2 class="blog-post-title"><a href="http://dyerlab/2015/01/extracting-data-from-rasters/">Extracting Data from Rasters</a></h2>
    <p class="blog-post-meta"><time datetime="2015-01-10T00:00:00Z">Sat Jan 10, 2015</time> by Rodney J. Dyer in 
<i class="fa fa-folder" aria-hidden="true"></i>&nbsp;<a href="/categories/araptus-attenuata" rel="category tag">Araptus attenuata</a>, <a href="/categories/baja-california" rel="category tag">Baja California</a>, <a href="/categories/code" rel="category tag">Code</a>, <a href="/categories/ggplot2" rel="category tag">ggplot2</a>, <a href="/categories/r" rel="category tag">R</a>, <a href="/categories/raster" rel="category tag">raster</a>, <a href="/categories/tutorials" rel="category tag">Tutorials</a>


</p>
  </header>
  

<p>This document shows you how to extract data from rasters.</p>

<h2 id="getting-the-libraries">Getting The Libraries</h2>

<p>First, I&rsquo;ll load in some packages to get the ability to work with raster data and to load in the <em>Arapatus attenuatus</em> data set (it is part of the default <strong>gstudio</strong> package).</p>

<p>require(raster)
require(gstudio)</p>

<p>##
##Loading and Cropping Rasters
We can load in the raster, and then crop it to just the are we need. These rasters were downloaded from [
<a href="http://www.worldclim.org/">http://www.worldclim.org</a>] and are much larger than the study area. This just makes it easier on the computer to not have to deal with such large areas. After cropping it, we will load in the annual precip and temperature data as well.
tmp &lt;- raster(&ldquo;alt_22.bil&rdquo;)
e &lt;- extent(c(-115, -109, 22, 30))
baja_alt &lt;- crop(tmp, e)
baja_temp &lt;- crop(raster(&ldquo;bio1_22.bil&rdquo;), e)
baja_prec &lt;- crop(raster(&ldquo;bio12_22.bil&rdquo;), e)</p>

<p>##
##Getting Example Data from
Araptus attenuatus
Now, lets grab the
Araptus data and look at the data and plot out the locations.
data(arapat)
summary(arapat)</p>

<h2 id="species-cluster-population-id-latitude">Species      Cluster      Population        ID         Latitude</h2>

<h2 id="cladea-75-cbp-c-150-32-19-101-10a-1-min-23-1">CladeA: 75   CBP-C :150   32     : 19   101_10A:  1   Min.   :23.1</h2>

<h2 id="cladeb-36-nbp-c-84-75-11-101-1a-1-1st-qu-24-6">CladeB: 36   NBP-C : 84   75     : 11   101_1A :  1   1st Qu.:24.6</h2>

<h2 id="cladec-252-sbp-c-18-const-11-101-2a-1-median-26-2">CladeC:252   SBP-C : 18   Const  : 11   101_2A :  1   Median :26.2</h2>

<h2 id="scbp-a-75-12-10-101-3a-1-mean-26-3">SCBP-A: 75   12     : 10   101_3A :  1   Mean   :26.3</h2>

<h2 id="son-b-36-153-10-101-4a-1-3rd-qu-27-5">SON-B : 36   153    : 10   101_4A :  1   3rd Qu.:27.5</h2>

<h2 id="157-10-101-5a-1-max-29-3">157    : 10   101_5A :  1   Max.   :29.3</h2>

<h2 id="other-292-other-357">(Other):292   (Other):357</h2>

<h2 id="longitude-ltrs-wnt-en-ef">Longitude       LTRS          WNT            EN          EF</h2>

<h2 id="min-114-01-01-147-03-03-108-01-01-225-2">Min.   :-114   01:01:147   03:03  :108   01:01  :225        :  2</h2>

<h2 id="1st-qu-113-01-02-86-01-01-82-01-02-52-01-01-219">1st Qu.:-113   01:02: 86   01:01  : 82   01:02  : 52   01:01:219</h2>

<h2 id="median-112-02-02-130-01-03-77-02-02-38-01-02-52">Median :-112   02:02:130   01:03  : 77   02:02  : 38   01:02: 52</h2>

<h2 id="mean-112-02-02-62-03-03-22-02-02-90">Mean   :-112               02:02  : 62   03:03  : 22   02:02: 90</h2>

<h2 id="3rd-qu-110-11-01-03-7">3rd Qu.:-110                      : 11   01:03  :  7</h2>

<h2 id="max-109-03-04-8-03-04-6">Max.   :-109               03:04  :  8   03:04  :  6</h2>

<h2 id="other-15-other-13">(Other): 15   (Other): 13</h2>

<h2 id="zmp-aml-atps-mp20">ZMP           AML           ATPS          MP20</h2>

<h2 id="33-08-08-51-05-05-155-05-07-64">: 33   08:08  : 51   05:05  :155   05:07  : 64</h2>

<h2 id="01-01-46-07-07-42-03-03-69-07-07-53">01:01: 46   07:07  : 42   03:03  : 69   07:07  : 53</h2>

<h2 id="01-02-51-07-08-42-09-09-66-18-18-52">01:02: 51   07:08  : 42   09:09  : 66   18:18  : 52</h2>

<h2 id="02-02-233-04-04-41-02-02-30-05-05-48">02:02:233   04:04  : 41   02:02  : 30   05:05  : 48</h2>

<h2 id="23-07-09-14-05-06-22">: 23   07:09  : 14   05:06  : 22</h2>

<h2 id="07-09-22-08-08-9-11-11-12">07:09  : 22   08:08  :  9   11:11  : 12</h2>

<h2 id="other-142-other-20-other-112">(Other):142   (Other): 20   (Other):112</h2>

<p>plot(arapat, zoom = 6)
<img src="http://dyerlab.bio.vcu.edu/wp-content/uploads/sites/4831/2015/01/png-3.png" alt="png-3" />
##Extracting Point Data
To elevation, temperature and precipitation from the rasters for each sampling location, we need to translate them into points first. I&rsquo;ll first grab the coordinate data as a
data.frame.
coords &lt;- StrataCoordinates(arapat)</p>

<p>Then we can grab them using the normal functions in the
<strong>sp</strong>
 library.
pts &lt;- SpatialPoints(coords[, 2:3])
coords$elev &lt;- extract(baja_alt, pts)
coords$temp &lt;- extract(baja_temp, pts)
coords$prec &lt;- extract(baja_prec, pts)
coords</p>

<h2 id="strata-longitude-latitude-elev-temp-prec">Strata Longitude Latitude elev temp prec</h2>

<h2 id="1-88-114-3-29-33-681-178-143">1       88    -114.3    29.33  681  178  143</h2>

<h2 id="11-9-113-9-29-01-361-195-148">11       9    -113.9    29.01  361  195  148</h2>

<h2 id="20-84-113-7-28-97-368-197-124">20      84    -113.7    28.97  368  197  124</h2>

<h2 id="29-175-113-5-28-73-240-205-106">29     175    -113.5    28.73  240  205  106</h2>

<h2 id="36-177-114-0-28-66-177-203-120">36     177    -114.0    28.66  177  203  120</h2>

<h2 id="46-173-112-9-28-41-26-223-102">46     173    -112.9    28.41   26  223  102</h2>

<h2 id="56-171-113-2-28-22-522-195-145">56     171    -113.2    28.22  522  195  145</h2>

<h2 id="66-89-113-4-28-04-290-203-117">66      89    -113.4    28.04  290  203  117</h2>

<h2 id="76-159-113-3-27-53-87-211-123">76     159    -113.3    27.53   87  211  123</h2>

<h2 id="85-sfr-113-0-27-36-305-205-107">85     SFr    -113.0    27.36  305  205  107</h2>

<h2 id="94-160-112-5-27-40-371-212-124">94     160    -112.5    27.40  371  212  124</h2>

<h2 id="104-162-112-4-27-20-248-220-119">104    162    -112.4    27.20  248  220  119</h2>

<h2 id="114-12-112-7-27-18-488-202-130">114     12    -112.7    27.18  488  202  130</h2>

<h2 id="124-161-113-0-27-04-29-216-91">124    161    -113.0    27.04   29  216   91</h2>

<h2 id="134-93-112-0-26-95-66-230-81">134     93    -112.0    26.95   66  230   81</h2>

<h2 id="144-165-112-4-26-25-na-na-na">144    165    -112.4    26.25   NA   NA   NA</h2>

<h2 id="154-169-111-4-26-21-6-238-134">154    169    -111.4    26.21    6  238  134</h2>

<h2 id="164-58-111-4-26-02-12-240-129">164     58    -111.4    26.02   12  240  129</h2>

<h2 id="173-166-112-1-25-91-70-224-84">173    166    -112.1    25.91   70  224   84</h2>

<h2 id="183-64-111-3-25-61-397-214-245">183     64    -111.3    25.61  397  214  245</h2>

<h2 id="188-168-111-2-25-56-354-217-235">188    168    -111.2    25.56  354  217  235</h2>

<h2 id="198-51-111-6-25-35-80-222-140">198     51    -111.6    25.35   80  222  140</h2>

<h2 id="205-const-111-7-25-02-50-217-127">205  Const    -111.7    25.02   50  217  127</h2>

<h2 id="216-77-110-7-24-88-52-231-193">216     77    -110.7    24.88   52  231  193</h2>

<h2 id="226-164-111-5-24-75-35-213-95">226    164    -111.5    24.75   35  213   95</h2>

<h2 id="236-75-110-7-24-59-21-231-166">236     75    -110.7    24.59   21  231  166</h2>

<h2 id="247-163-111-0-24-21-196-219-127">247    163    -111.0    24.21  196  219  127</h2>

<h2 id="257-esan-110-4-24-46-9-237-175">257   ESan    -110.4    24.46    9  237  175</h2>

<h2 id="265-153-110-5-24-13-31-235-165">265    153    -110.5    24.13   31  235  165</h2>

<h2 id="275-48-110-3-24-21-117-233-217">275     48    -110.3    24.21  117  233  217</h2>

<h2 id="285-156-110-0-24-04-0-237-196">285    156    -110.0    24.04    0  237  196</h2>

<h2 id="291-157-110-1-24-02-609-208-443">291    157    -110.1    24.02  609  208  443</h2>

<h2 id="301-73-109-9-24-01-103-233-227">301     73    -109.9    24.01  103  233  227</h2>

<h2 id="311-aqu-110-1-23-29-142-226-227">311    Aqu    -110.1    23.29  142  226  227</h2>

<h2 id="319-mat-110-1-23-09-5-234-159">319    Mat    -110.1    23.09    5  234  159</h2>

<h2 id="324-98-109-6-23-08-75-237-233">324     98    -109.6    23.08   75  237  233</h2>

<h2 id="328-101-110-6-27-91-8-249-244">328    101    -110.6    27.91    8  249  244</h2>

<h2 id="337-32-109-3-26-64-18-244-337">337     32    -109.3    26.64   18  244  337</h2>

<h2 id="356-102-109-1-26-38-10-245-346">356    102    -109.1    26.38   10  245  346</h2>

<p>##
##Plotting Trend lines.
Cool, lets sort this by latitude
coords &lt;- coords[order(coords$Latitude), ]</p>

<p>and then plot out some values to look at what is going on.
require(ggplot2)
ggplot(coords, aes(x = Latitude, y = elev)) + geom_line(color = &ldquo;gray&rdquo;) + theme_bw() + geom_text(aes(y = elev + 10, label = Strata), color = &ldquo;blue&rdquo;)
<img src="http://rampages.us/dyerlab/wp-content/uploads/sites/4831/2015/01/png.png" alt="png" /></p>

<p>ggplot(coords, aes(x = Latitude, y = temp)) + geom_line(color = &ldquo;gray&rdquo;) + theme_bw() + geom_text(aes(y = temp + 5, label = Strata), color = &ldquo;blue&rdquo;)
<a href="http://rampages.us/dyerlab/wp-content/uploads/sites/4831/2015/01/png-1.png"><img src="http://rampages.us/dyerlab/wp-content/uploads/sites/4831/2015/01/png-1.png" alt="png-1" /></a>
ggplot(coords, aes(x = Latitude, y = prec)) + geom_line(color = &ldquo;gray&rdquo;) + theme_bw() + geom_text(aes(y = prec + 10, label = Strata), color = &ldquo;blue&rdquo;)</p>

<p><a href="http://rampages.us/dyerlab/wp-content/uploads/sites/4831/2015/01/png-2.png"><img src="http://rampages.us/dyerlab/wp-content/uploads/sites/4831/2015/01/png-2.png" alt="png-2" /></a></p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4>Share</h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fdyerlab%2f2015%2f01%2fextracting-data-from-rasters%2f" title="Share on Facebook"><span class="fa fa-facebook fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://plus.google.com/share?url=http%3a%2f%2fdyerlab%2f2015%2f01%2fextracting-data-from-rasters%2f" title="Share on Google+"><span class="fa fa-google-plus fa-2x" aria-hidden="true"></span></a>
      
      <a class="nav-item" href="https://twitter.com/home?status=http%3a%2f%2fdyerlab%2f2015%2f01%2fextracting-data-from-rasters%2f" title="Tweet this"><span class="fa fa-twitter fa-2x"></span></a>
    </nav>
  </section>

  

  
  </footer>
  

</article> 



        </div> <!-- /.blog-main -->

        <aside class="col-sm-3 offset-sm-1 blog-sidebar">
  
  
  

  <section class="sidebar-module  sidebar-module-inset">
    <h4>Recent Posts</h4>
    <ol class="list-unstyled">
      
      <li><a href="/2017/01/new-server-new-site-first-post/">New Server, New Site, First Post!</a></li>
      
      <li><a href="/2017/01/new-position/">New Position</a></li>
      
      <li><a href="/2016/12/life-sciences-graduation/">Life Sciences Graduation</a></li>
      
      <li><a href="/2016/11/talk-at-temple/">Talk at Temple!</a></li>
      
      <li><a href="/2016/10/spatial-data-sources/">Spatial Data Sources</a></li>
      
    </ol>
  </section>

  
  
  <section class="sidebar-module sidebar-module-inset">
  <h5>Search Dyerlab</h5>
  <gcse:searchbox-only></gcse:searchbox-only>
  </section>
  
  
  <section class="sidebar-module sidebar-module-inset">
    <h4>Links</h4>
    <ol class="list-unstyled">
      
      <li><a href="http://dyerlab.com/categories">Blog Tags</a></li>
      
      <li><a href="http://dyerlab.com/rstudio">RStudio</a></li>
      
      <li><a href="https://github.com/dyerlab">Github</a></li>
      
    </ol>
  </section>
  
  
  <div class="twitter-timeline">
    <a class="twitter-timeline" href="https://twitter.com/Dyerlab" data-height="1200">Tweets by Dyerlab</a><script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</aside>


      </div> <!-- /.row -->
    </div> <!-- /.container -->

    <footer class="blog-footer">
      <p>
      
      &copy; by 2017 <a href="mailto:rjdyer@vcu.edu">R.J. Dyer</a>.
      
      </p>
      <p>
      <a href="#">Back to top</a>
      </p>
    </footer>

  </body>

</html>
